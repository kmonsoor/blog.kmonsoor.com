<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>I think ... - go-link</title><link href="https://blog.kmonsoor.com/" rel="alternate"></link><link href="https://blog.kmonsoor.com/tag/go-link/feed/atom/index.html" rel="self"></link><id>https://blog.kmonsoor.com/</id><updated>2021-06-06T00:00:00+06:00</updated><entry><title>Create a free go-link server “on edge” using Cloudflare Worker KV</title><link href="https://blog.kmonsoor.com/golink-server-using-cloudflare-worker-kv/" rel="alternate"></link><published>2021-06-06T00:00:00+06:00</published><updated>2021-06-06T00:00:00+06:00</updated><author><name>Khaled Monsoor</name></author><id>tag:blog.kmonsoor.com,2021-06-06:/golink-server-using-cloudflare-worker-kv/</id><summary type="html">&lt;p&gt;Among quite a few ways to implement a go-link server (i.e., url-forwarder, short-url server, etc.), I will show how to use free-tier Cloudflare Worker (&amp;amp; &lt;span class="caps"&gt;KV&lt;/span&gt;) to create an in-house, on-edge, &lt;strong&gt;no-webserver&lt;/strong&gt; go-link&amp;nbsp;server.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Among quite a few ways to implement a go-link server (i.e., url-forwarder, short-url server, etc.), I&amp;rsquo;m going to show you how to use free-tier Cloudflare Worker (&amp;amp; &lt;span class="caps"&gt;KV&lt;/span&gt;) to create an in-house, on-edge, &lt;strong&gt;no-webserver&lt;/strong&gt; go-link&amp;nbsp;server.&lt;/p&gt;
&lt;p&gt;For example, the short-link for this article is &lt;a href="https://go.kmonsoor.com/golink-kv"&gt;go.kmonsoor.com/golink-kv&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;&lt;img alt="overall structure" src="https://i.imgur.com/MjIS5gD.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/latest&lt;/code&gt; (by which I mean &lt;code&gt;go.yourdomain.co/latest&lt;/code&gt;) may point to &lt;code&gt;https://www.yourcompany.com/about/news&lt;/code&gt; which is a public&amp;nbsp;page&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/hr-help&lt;/code&gt; may point to &lt;code&gt;https://www.company-internal.com/long-link/hr/contact.html&lt;/code&gt;, which is company&amp;rsquo;s internal human-resources help&amp;nbsp;portal&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/cnypromo&lt;/code&gt; may point to &lt;code&gt;https://shop.yourcompany.com/sales/promotions/?marketing-promo=2021-cny&lt;/code&gt; which is a temporary sales promotions page targeting the shoppers during the Chinese new year of&amp;nbsp;2021.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Please note that using the setup and the code below, it&amp;rsquo;ll be possible to resolve short-links via a &lt;strong&gt;single&lt;/strong&gt; sub-domain, e.g., &lt;code&gt;go.your-domain.co&lt;/code&gt;. However, it&amp;rsquo;s possible (with some modification of the code) to resolve/redirect via &lt;em&gt;any number of domains&lt;/em&gt; (your own, of course) towards any other public or private &lt;span class="caps"&gt;URL&lt;/span&gt;, and all sorts of novelties. However, for brevity&amp;rsquo;s sake, I will discuss the first one, a single sub-domain&amp;nbsp;usecase.&lt;/p&gt;
&lt;p&gt;To set up a go-link server or short-&lt;span class="caps"&gt;URL&lt;/span&gt; resolver via a proper &lt;span class="caps"&gt;KV&lt;/span&gt;+Worker combination, we&amp;rsquo;ll go through these&amp;nbsp;steps:&lt;/p&gt;
&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#pre-requisites"&gt;Pre-requisites&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#create-the-short-link-map-as-a-kv"&gt;Create the short-link map as a &lt;span class="caps"&gt;KV&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#mapping-a-kv-to-a-worker-variable"&gt;Mapping a &lt;span class="caps"&gt;KV&lt;/span&gt; to a Worker&amp;nbsp;variable&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#handling-a-route-with-webworker"&gt;Handling a route with&amp;nbsp;webworker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#create-the-worker"&gt;Create the&amp;nbsp;Worker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pointing-a-dns-record-to-the-worker"&gt;Pointing a &lt;span class="caps"&gt;DNS&lt;/span&gt; record to the&amp;nbsp;Worker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#next-step"&gt;Next&amp;nbsp;step&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#related"&gt;Related&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h1 id="pre-requisites"&gt;Pre-requisites&lt;a class="headerlink" href="#pre-requisites" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;span class="caps"&gt;DNS&lt;/span&gt; resolver for the &lt;strong&gt;root&lt;/strong&gt; domain (in the example below, &lt;em&gt;&lt;code&gt;kmonsoor.com&lt;/code&gt;&lt;/em&gt;) needs to be Cloudflare. Because the core of the solution, the &amp;ldquo;worker&amp;rdquo;, runs on the nearest (from the user) edge of Cloudflare using a standard &lt;span class="caps"&gt;KV&lt;/span&gt; (&amp;ldquo;key, value&amp;rdquo;)&amp;nbsp;list.&lt;/li&gt;
&lt;li&gt;Write permission to the &lt;span class="caps"&gt;DNS&lt;/span&gt; configuration as you&amp;rsquo;d need to add a new &lt;span class="caps"&gt;AAAA&lt;/span&gt; &lt;span class="caps"&gt;DNS&lt;/span&gt;&amp;nbsp;record.&lt;/li&gt;
&lt;li&gt;Some knowledge of Javascript(&lt;code&gt;ES6&lt;/code&gt;), as we are going to write the &amp;ldquo;worker&amp;rdquo; in that&amp;nbsp;language.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="create-the-short-link-map-as-a-kv"&gt;Create the short-link map as a &lt;span class="caps"&gt;KV&lt;/span&gt;&lt;a class="headerlink" href="#create-the-short-link-map-as-a-kv" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;We&amp;rsquo;ll start the setup by creating the short-link map, the list between the short-link segments that you (or someone in your org) define, and the actual URLs they need to point&amp;nbsp;to.&lt;/p&gt;
&lt;p&gt;Find the &lt;span class="caps"&gt;KV&lt;/span&gt; stuff in the &lt;code&gt;Workers&lt;/code&gt; section. From the screenshot, please ignore the &amp;ldquo;Route&amp;rdquo; section for&amp;nbsp;now.  &lt;/p&gt;
&lt;p&gt;&lt;img alt="Find the KV stuff in the Workers section" src="https://i.imgur.com/b2Rk45u.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;you&amp;rsquo;d need to create a Worker &lt;span class="caps"&gt;KV&lt;/span&gt; &amp;ldquo;Namespace&amp;rdquo;. Name the namespace as you seem fit. I named it &lt;code&gt;REDIRECTS&lt;/code&gt; (in all caps just as a convention, not&amp;nbsp;required). &lt;/li&gt;
&lt;li&gt;List the short links &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; their respective target URLs. From the examples in the intro, the keys &lt;code&gt;latest&lt;/code&gt;, &lt;code&gt;hr-help&lt;/code&gt;, &lt;code&gt;cnypromo&lt;/code&gt; etc. would be in as the &amp;ldquo;key&amp;rdquo;, and the target full links as the respective&amp;nbsp;&amp;ldquo;value&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Remember &lt;span class="caps"&gt;NOT&lt;/span&gt; to start the short part with &amp;lsquo;/&amp;rsquo;. It&amp;rsquo;ll be taken care of in the&amp;nbsp;code.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Create the short-link map as a KV" src="https://i.imgur.com/jkC8bSr.png"&gt;&lt;/p&gt;
&lt;p&gt;Once you&amp;rsquo;ve listed all your desired (short-link, target-link) combinations, now we have a &lt;span class="caps"&gt;KV&lt;/span&gt; on Cloudflare. However, it&amp;rsquo;s not referencable from your Worker code, not yet. Hence the next&amp;nbsp;step.&lt;/p&gt;
&lt;h1 id="mapping-a-kv-to-a-worker-variable"&gt;Mapping a &lt;span class="caps"&gt;KV&lt;/span&gt; to a Worker variable&lt;a class="headerlink" href="#mapping-a-kv-to-a-worker-variable" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;Now, we will map the previously created &lt;span class="caps"&gt;KV&lt;/span&gt; to a variable that can be referenced from our Worker code. Please note that though I used different names, it can be the same as well. Also, note that multiple Workers can access a single &lt;span class="caps"&gt;KV&lt;/span&gt;, and vice versa is also true; a single Worker can reference multiple&amp;nbsp;KVs.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Mapping a KV to a Worker variable" src="https://i.imgur.com/lb7G9si.png"&gt;&lt;/p&gt;
&lt;h1 id="handling-a-route-with-webworker"&gt;Handling a route with webworker&lt;a class="headerlink" href="#handling-a-route-with-webworker" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;&lt;img alt="Handling a route with webworker" src="https://i.imgur.com/KohHRfR.png"&gt;&lt;/p&gt;
&lt;h1 id="create-the-worker"&gt;Create the Worker&lt;a class="headerlink" href="#create-the-worker" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;Now, we will write Worker-code that runs on &lt;code&gt;V8&lt;/code&gt; runtime on the nearest (from the requesting user) &amp;ldquo;edge&amp;rdquo; location of Cloudflare, to execute the code and deliver the result(s) to the user. In this case, that would be to redirect user-requested address to the mapped one (by you, in the &lt;span class="caps"&gt;KV&lt;/span&gt; namespace&amp;nbsp;above).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Creating a worker" src="https://i.imgur.com/eNfZNyN.png"&gt;&lt;/p&gt;
&lt;p&gt;The code editor looks like&amp;nbsp;this:  &lt;/p&gt;
&lt;p&gt;&lt;img alt="The code editor for Cloudflare worker" src="https://i.imgur.com/pb9AE9v.png"&gt;&lt;/p&gt;
&lt;p&gt;If you rather prefer to copy-paste, please feel free to do it from the below GitHub&amp;nbsp;Gist.&lt;/p&gt;
&lt;div class="gist"&gt;
&lt;script src="https://gist.github.com/kmonsoor/dc9f96660423c96471f8574ba018d867.js"&gt;&lt;/script&gt;
&lt;/div&gt;

&lt;p&gt;Once done, it should look like &amp;hellip;
&lt;img alt="created webworker" src="https://i.imgur.com/XSdKB56.png"&gt;&lt;/p&gt;
&lt;h1 id="pointing-a-dns-record-to-the-worker"&gt;Pointing a &lt;span class="caps"&gt;DNS&lt;/span&gt; record to the Worker&lt;a class="headerlink" href="#pointing-a-dns-record-to-the-worker" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;Finally, we need to point a &lt;span class="caps"&gt;DNS&lt;/span&gt; record that&amp;rsquo;ll redirect all requests to your re-soutign sub-domain (e.g. &lt;code&gt;go.your-domain.com&lt;/code&gt;) to the Cloudflare Worker that we just&amp;nbsp;created.&lt;/p&gt;
&lt;p&gt;According to the Cloudflare docs, the &lt;span class="caps"&gt;DNNS&lt;/span&gt; record must be an &lt;span class="caps"&gt;AAAA&lt;/span&gt; record, pointing to the IPv6 address &lt;code&gt;100::&lt;/code&gt;. The &amp;ldquo;Name&amp;rdquo; here is the &amp;ldquo;sub-domain&amp;rdquo; part of your choice, which is better be short, to rightfully serve our goal&amp;nbsp;here.  &lt;/p&gt;
&lt;p&gt;&lt;img alt="Pointing a DNS record to it" src="https://i.imgur.com/62bk7pe.png"&gt;&lt;/p&gt;
&lt;p&gt;Voila ! Now, test some of the short-urls that you&amp;rsquo;ve mapped via the &lt;span class="caps"&gt;KV&lt;/span&gt;. Enjoy !
Watch out for the target usage though. &lt;a href="https://developers.cloudflare.com/workers/platform/limits#worker-limits"&gt;Here&amp;rsquo;s the limit&lt;/a&gt;.  &lt;/p&gt;
&lt;p&gt;I think you&amp;rsquo;ll be fine, unless you&amp;rsquo;re some celebrity&amp;nbsp;;)&lt;/p&gt;
&lt;h1 id="next-step"&gt;Next step&lt;a class="headerlink" href="#next-step" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;As the next step, I&amp;rsquo;m thinking to create a generic &lt;code&gt;Go/Link&lt;/code&gt; resolver browser extension. Then, someone can set their own default domain or company domain of choice as short-domain host. In that case, entering just &lt;code&gt;go/hr-help&lt;/code&gt; on the browser will take to &lt;code&gt;https://www.company-internal.com/.../hr/contact.html&lt;/code&gt; that we have discussed at the beginning (remember the example case of an internal human resources help&amp;nbsp;portal?).&lt;/p&gt;
&lt;h1 id="related"&gt;Related&lt;a class="headerlink" href="#related" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;If you want to do this url-direction &lt;strong&gt;on your server, but only using webserver&lt;/strong&gt;, try this: &lt;a href="https://blog.kmonsoor.com/personal-shortlink-server-using-Caddy/"&gt;Personal short-link server using only&amp;nbsp;Caddyserver&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;If you find this post helpful, you can show your support &lt;a href="https://www.patreon.com/kmonsoor"&gt;through Patreon&lt;/a&gt; or by &lt;a href="https://ko-fi.com/kmonsoor"&gt;buying me a coffee&lt;/a&gt;. &lt;em&gt;Thanks!&lt;/em&gt;&lt;/p&gt;</content><category term="Tech"></category><category term="cloud"></category><category term="computing"></category><category term="url-shortener"></category><category term="url-forwarder"></category><category term="Cloudflare"></category><category term="Cloudflare Worker"></category><category term="Cloudflare KV"></category><category term="Workers KV"></category><category term="on edge"></category><category term="free"></category><category term="go-link"></category></entry><entry><title>Deploying a short-link aka go-link server using only Caddyserver</title><link href="https://blog.kmonsoor.com/deploying-golink-server-using-Caddy/" rel="alternate"></link><published>2021-04-16T00:00:00+06:00</published><updated>2021-04-16T00:00:00+06:00</updated><author><name>Khaled Monsoor</name></author><id>tag:blog.kmonsoor.com,2021-04-16:/deploying-golink-server-using-Caddy/</id><summary type="html">&lt;p&gt;Yeah, there are tons of open-source, full-fledged link-shorteners. But, none were exactly what I wanted. Hence, the minimal approach only by utilizing an amazing webserver, &lt;code&gt;Caddy&lt;/code&gt;. Here we go&amp;nbsp;&amp;hellip;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Before I go into any details, please note that I&amp;rsquo;ve used the term &amp;ldquo;shortlink-server&amp;rdquo; instead of &amp;ldquo;url-shortener&amp;rdquo; because the difference is significant for this post.
A url-shortener takes a long url, and gives a short url, then redirects any requests for the shortened link to its longer counterpart. On the contrary, shortlink-server takes both the long and short url as inputs, then only does the redirect-ion&amp;nbsp;part.&lt;/p&gt;
&lt;h2 id="backstory"&gt;Backstory&lt;a class="headerlink" href="#backstory" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If I wanted a fantastic, personal url-shortener or &amp;ldquo;go link&amp;rdquo; server, there are many excellent solutions out there, which are not only free or open-source but full-fledged as well for personal or public usage. Instead, I wanted some &amp;ldquo;service&amp;rdquo; that would &amp;ldquo;resolve&amp;rdquo; my personal, short links. I have been using bit.ly for a long time for its customizable &amp;ldquo;short-half&amp;rdquo; part, but the problem with bit.ly is &amp;ndash; for some God-forsaken reason &amp;ndash; blocked by the Bangladeshi govt. So, I needed a replacement to be appropriately &amp;ldquo;glocal&amp;rdquo;.
There are many free (unbranded) and commercial (branded) options as well, but I wanted something that would be resolved via my hosted service (and personal domain) and as cheap as possible. So, basically solution for a poor nerd&amp;nbsp;:D&lt;/p&gt;
&lt;p&gt;Before jumped into this solution, I tried (deployed &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; tested) few others myself, mainly &lt;a href="https://github.com/kellegous/go"&gt;kellegous/go&lt;/a&gt;, &lt;a href="kutt.it"&gt;kutt.it&lt;/a&gt; and &lt;a href="https://github.com/adamyi/golinks"&gt;adamyi/golinks&lt;/a&gt;. But, all of them &amp;ldquo;too featureful&amp;rdquo; for my&amp;nbsp;needs.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Simple, on-prem short-link server using Caddy webserver" src="https://i.imgur.com/4nZbnUE.png"&gt;&lt;/p&gt;
&lt;p&gt;What I wanted is to be able&amp;nbsp;to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;resolve only my custom shortlinks (hence, no need for&amp;nbsp;url-shortener)&lt;/li&gt;
&lt;li&gt;not a public, internet-facing service (hence, any frontend, authentication, email verification etc. would be overkill&amp;nbsp;)&lt;/li&gt;
&lt;li&gt;minimal setup (if possible, no webapp at&amp;nbsp;all)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Given my previous experience with &lt;code&gt;Caddy&lt;/code&gt; webserver, which is an amazing one(&lt;a href="https://caddyserver.com/docs/"&gt;why?&lt;/a&gt;), I had a gut feeling that Caddy has something for me &amp;ndash; under the sleeve &amp;ndash; to meet my minimal set of requirements. Thankfully, I managed to find&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;I believe &lt;span class="caps"&gt;NGINX&lt;/span&gt;, currently the most popular webserver, has some kind of similar mechanism as well. But, I&amp;rsquo;m not an expert, and once I was genuinely intimidated by its config file syntax. &lt;span class="caps"&gt;YMMV&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id="what-you-gonna-need"&gt;What you gonna need?&lt;a class="headerlink" href="#what-you-gonna-need" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;your own domain which will be the root of the shortlinks. While sub-domained &lt;span class="caps"&gt;URL&lt;/span&gt; like &lt;code&gt;go.company-name.com/*&lt;/code&gt; is quite common, if you have some short domain, like you.co/*, only for this purpose, that&amp;rsquo;s fine as&amp;nbsp;well.&lt;/li&gt;
&lt;li&gt;A web-host server or public-facing instance with its own, &lt;strong&gt;public IPv4 address&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;working knowledge of&amp;nbsp;Linux&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="step-1-point-your-subdomain-to-the-right-place"&gt;Step-1: Point your subdomain to the right place&lt;a class="headerlink" href="#step-1-point-your-subdomain-to-the-right-place" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Find out what&amp;rsquo;s the &lt;strong&gt;puplic IPv4 address&lt;/strong&gt; of your instance that&amp;rsquo;ll act as the webserver. It&amp;rsquo;s usually on the cloud management&amp;nbsp;dashboard.&lt;/li&gt;
&lt;li&gt;make sure that, regardless of your cloud architecture (e.g. &lt;span class="caps"&gt;VPC&lt;/span&gt;, subnet, firewall etc.), the &lt;span class="caps"&gt;SSL&lt;/span&gt; port (&lt;code&gt;:443&lt;/code&gt;) of the instance is reachable from the public&amp;nbsp;internet.&lt;/li&gt;
&lt;li&gt;now go to your domain name registrar (or, &lt;span class="caps"&gt;DNS&lt;/span&gt; management provider which in my case is Cloudflare). There, you need to point shortlink subdomain (&lt;code&gt;go.&lt;/code&gt;)to the webserver&amp;rsquo;s &lt;span class="caps"&gt;I.P.&lt;/span&gt; address. In &lt;span class="caps"&gt;DNS&lt;/span&gt; terms, you&amp;rsquo;ll be creating a &lt;span class="caps"&gt;CNAME&lt;/span&gt; entry on the domain&amp;rsquo;s nameserver&amp;nbsp;table.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can do this step as the last one. But for some reason, I prefer it to do first. Because sometimes, &lt;a href="https://blog.cloudflare.com/never-deal-with-dns-propagation-again/"&gt;&lt;span class="caps"&gt;DNS&lt;/span&gt; propagation&lt;/a&gt; takes some time. But, once my web service is up and running, I like to see the result instantaneously.&amp;nbsp;;)&lt;/p&gt;
&lt;h2 id="step-2-install-caddy-a-mighty-webserver"&gt;Step-2: Install Caddy, a mighty webserver&lt;a class="headerlink" href="#step-2-install-caddy-a-mighty-webserver" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Depending on your host &lt;span class="caps"&gt;OS&lt;/span&gt; (Ubuntu 20.04 &lt;span class="caps"&gt;LTS&lt;/span&gt; in my case), you need to &lt;a href="https://caddyserver.com/docs/install"&gt;install the &lt;code&gt;Caddy&lt;/code&gt; webserver&lt;/a&gt;. While there are some hacky solutions to run, I think running &lt;code&gt;Caddy&lt;/code&gt; as a background service is the simplest to manage.
In fact, the documentation of Caddy is excellent, so I&amp;rsquo;d better leave that part to&amp;nbsp;you.&lt;/p&gt;
&lt;p&gt;After running with the default config(&lt;code&gt;Caddyfile&lt;/code&gt;), (in Ubuntu&amp;rsquo;s case, located as &lt;code&gt;/etc/caddy/Caddyfile&lt;/code&gt;), it should show a status somewhat like the below image. Please note that, in many cases, if running without &lt;code&gt;sudo&lt;/code&gt;, Caddy cannot attach itself with the &lt;span class="caps"&gt;SSL&lt;/span&gt; port (&lt;code&gt;:443&lt;/code&gt;), which is necessary for serving &lt;code&gt;https://&lt;/code&gt;.  So, check for that error message in the &amp;ldquo;status&amp;rdquo;&amp;nbsp;log.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Caddy service on Ubuntu" src="https://i.imgur.com/cfS5nvZ.png?1"&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;&lt;span class="caps"&gt;PS&lt;/span&gt;:&lt;/strong&gt; By the way, want your console and command prompt to look 🚀 like mine? Here&amp;rsquo;s the guide: &lt;a href="https://blog.kmonsoor.com/pimp-up-my-terminal/"&gt;How do I pimp up my terminal on&amp;nbsp;Linux&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="step-3-tell-caddy-your-short-links-to-redirect"&gt;Step-3: Tell Caddy your short-links to redirect&lt;a class="headerlink" href="#step-3-tell-caddy-your-short-links-to-redirect" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now, it&amp;rsquo;s time to configure Caddy to actually do the&amp;nbsp;job.&lt;/p&gt;
&lt;p&gt;Caddy has its native &lt;code&gt;redir&lt;/code&gt; &lt;span class="dquo"&gt;&amp;ldquo;&lt;/span&gt;directive&amp;rdquo; to redirect incoming web-request from one to another. While the &lt;code&gt;map&lt;/code&gt; directive is relatively new, it makes the config file, i.e., Caddyfile, look elegant in case you have (or will have in the long run) a long list of&amp;nbsp;short-links.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s mine, which is working nicely&amp;nbsp;&amp;hellip;  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="linenos" data-linenos=" 1 "&gt;&lt;/span&gt;# /etc/caddy/Caddyfile
&lt;span class="linenos" data-linenos=" 2 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos=" 3 "&gt;&lt;/span&gt;go.kmonsoor.com {   # replace it your web-url root
&lt;span class="linenos" data-linenos=" 4 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos=" 5 "&gt;&lt;/span&gt;    map {path} {redirect-uri} {
&lt;span class="linenos" data-linenos=" 6 "&gt;&lt;/span&gt;        /blog    https://blog.kmonsoor.com
&lt;span class="linenos" data-linenos=" 7 "&gt;&lt;/span&gt;        /photos  https://photos.kmonsoor.com
&lt;span class="linenos" data-linenos=" 8 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos=" 9 "&gt;&lt;/span&gt;        /resume     https://drive.google.com/file/d/1nMS3i1ai6nsI70zZ7NFnNQ_XmvAa4GOl
&lt;span class="linenos" data-linenos="10 "&gt;&lt;/span&gt;        /resume-doc https://docs.google.com/document/d/1ECx1Yr8Jzz9I3S5VcoKnZQz56oIht2XaM5gSNetcWag
&lt;span class="linenos" data-linenos="11 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos="12 "&gt;&lt;/span&gt;        /rickrolled    https://www.youtube.com/watch?v=dQw4w9WgXcQ
&lt;span class="linenos" data-linenos="13 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos="14 "&gt;&lt;/span&gt;        # will add new ones here like the above
&lt;span class="linenos" data-linenos="15 "&gt;&lt;/span&gt;        # ...
&lt;span class="linenos" data-linenos="16 "&gt;&lt;/span&gt;    }
&lt;span class="linenos" data-linenos="17 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos="18 "&gt;&lt;/span&gt;    # this below code is required to actually make the above `map` work
&lt;span class="linenos" data-linenos="19 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos="20 "&gt;&lt;/span&gt;    @hasRedir expression `{redirect-uri} != &amp;quot;&amp;quot;`
&lt;span class="linenos" data-linenos="21 "&gt;&lt;/span&gt;    redir @hasRedir {redirect-uri}
&lt;span class="linenos" data-linenos="22 "&gt;&lt;/span&gt;
&lt;span class="linenos" data-linenos="23 "&gt;&lt;/span&gt;    # code below is to set the default response if the requested shortlink isn&amp;#39;t here
&lt;span class="linenos" data-linenos="24 "&gt;&lt;/span&gt;    respond &amp;quot;Thas&amp;#39;s an unknown short URL ... :(&amp;quot;  
&lt;span class="linenos" data-linenos="25 "&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note: Don&amp;rsquo;t forget to restart the &lt;code&gt;caddy&lt;/code&gt; service to let the new config to take&amp;nbsp;effect.&lt;/p&gt;
&lt;h2 id="step-4-profit"&gt;Step-4: Profit&lt;a class="headerlink" href="#step-4-profit" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Yeah, that&amp;rsquo;s it. Now, add some own personal stuff with some cool short-links, and proudly share with the&amp;nbsp;world.&lt;/p&gt;
&lt;h2 id="whats-next"&gt;What&amp;rsquo;s next ?&lt;a class="headerlink" href="#whats-next" title="Permanent link"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;m thinking that given the very low workload my shortlink resolver needs — unless I&amp;rsquo;m becoming an overnight internet sensation — using a server instance only for this purpose is overkill. My next goal is to have the same service using some &amp;ldquo;serverless&amp;rdquo; function or using the &amp;ldquo;&lt;a href="https://developers.cloudflare.com/workers/examples/redirect"&gt;worker on the edge&lt;/a&gt;&amp;rdquo; thing from Cloudflare. Let&amp;rsquo;s see&amp;nbsp;;)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; Now, actually done it. Here is the link: &lt;a href="https://blog.kmonsoor.com/golink-server-using-cloudflare-worker-kv/"&gt;Free short-link server &amp;ldquo;on edge&amp;rdquo; using Cloudflare Worker &lt;span class="caps"&gt;K.V.&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;If you find this post helpful, you can show your support &lt;a href="https://www.patreon.com/kmonsoor"&gt;through Patreon&lt;/a&gt; or by &lt;a href="https://ko-fi.com/kmonsoor"&gt;buying me a coffee&lt;/a&gt;. &lt;em&gt;Thanks!&lt;/em&gt;&lt;/p&gt;</content><category term="Tech"></category><category term="caddy"></category><category term="webserver"></category><category term="url-shortener"></category><category term="Caddyfile"></category><category term="web-link"></category><category term="go-link"></category></entry></feed>